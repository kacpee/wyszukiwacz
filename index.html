<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <title>Wyszukiwacz</title>
  <link rel="icon" type="image/x-icon" href="wyszukiwacz.png">
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: white;
      padding: 20px;
      max-width: 600px;
    }
    label {
      display: block;
      margin: 5px 0;
    }
    input[type="text"] {
      width: 100%;
      padding: 8px;
      margin-bottom: 15px;
    }
    button {
      margin-top: 15px;
      padding: 10px 20px;
      font-size: 16px;
    }
    button:hover {
      background-color: #f0f0f0;
      cursor: pointer;
    }
    h3 {
      margin-top: 30px;
    }
    h2 {
      margin-top: 0px !important;
    }
    .button-group {
      margin-top: 20px;
    }
    .subcategory {
      margin-left: 15px;
    }
  </style>
</head>
<body>
  <h2>Wyszukiwacz v0.09</h2>

  <label for="searchTerm">Wpisz szukane hasło:</label>
  <input type="text" id="searchTerm" placeholder="Np. poszewka">

  <h3>Wybierz sklepy:</h3>

  <label><input type="checkbox" id="selectAll"> <strong>Zaznacz / Odznacz wszystkie</strong></label>
  
  <!-- Sklepy ogólne -->
  <label><input type="checkbox" class="shop" value="castorama"> Castorama</label>
  <label><input type="checkbox" class="shop" value="leroymerlin"> Leroy Merlin</label>
  <label><input type="checkbox" class="shop" value="obi"> OBI</label>
  <label><input type="checkbox" class="shop" value="mrowka"> Mrówka (brak możliwości sortowania po cenie)</label>
  <label><input type="checkbox" class="shop" value="action"> Action</label>
  <label><input type="checkbox" class="shop" value="jysk"> Jysk</label>
  <label><input type="checkbox" class="shop" value="empik"> Empik</label>

  <!-- Kategoria: Zwierzęta -->
  <h4>Zwierzęta:</h4>
  <div class="subcategory">
    <label><input type="checkbox" class="shop" value="zooplus"> Zooplus</label>
    <label><input type="checkbox" class="shop" value="maxizoo"> Maxi Zoo</label>
    <label><input type="checkbox" class="shop" value="bitiba"> Bitiba</label>
  </div>

  <!-- Checkbox Google -->
  <label><br><input type="checkbox" id="googleSearch"> Wyszukaj w Google (site:sklep.pl)</label>

  <div class="button-group">
    <button id="searchButton" onclick="search()" disabled>Szukaj</button>
    <button onclick="resetForm()">Resetuj</button>
  </div>

  <script>
    const selectAllCheckbox = document.getElementById("selectAll");
    const shopCheckboxes = document.querySelectorAll(".shop");
    const searchTermInput = document.getElementById("searchTerm");
    const searchButton = document.getElementById("searchButton");

    // Zaznacz/Odznacz wszystkie
    selectAllCheckbox.addEventListener("change", function () {
      shopCheckboxes.forEach(cb => cb.checked = this.checked);
    });

    // Synchronizacja checkboxów
    shopCheckboxes.forEach(cb => {
      cb.addEventListener("change", function () {
        const allChecked = Array.from(shopCheckboxes).every(cb => cb.checked);
        const noneChecked = Array.from(shopCheckboxes).every(cb => !cb.checked);

        if (allChecked) {
          selectAllCheckbox.checked = true;
          selectAllCheckbox.indeterminate = false;
        } else if (noneChecked) {
          selectAllCheckbox.checked = false;
          selectAllCheckbox.indeterminate = false;
        } else {
          selectAllCheckbox.checked = false;
          selectAllCheckbox.indeterminate = true;
        }
      });
    });

    // Aktywacja / dezaktywacja przycisku Szukaj
    searchTermInput.addEventListener("input", function () {
      searchButton.disabled = !this.value.trim();
    });

    // Obsługa Entera
    searchTermInput.addEventListener("keypress", function (e) {
      if (e.key === "Enter" && !searchButton.disabled) {
        search();
      }
    });

    // Wyszukiwanie
    function search() {
      const term = encodeURIComponent(searchTermInput.value.trim());
      const selectedShops = Array.from(document.querySelectorAll('.shop:checked')).map(cb => cb.value);
      const googleSearchEnabled = document.getElementById('googleSearch').checked;

      if (!term) {
        alert("Wpisz hasło do wyszukania.");
        return;
      }

      if (selectedShops.length === 0) {
        alert("Zaznacz co najmniej jeden sklep.");
        return;
      }

      const urls = {
        castorama: `https://www.castorama.pl/search?sort=product.price&term=${term}`,
        leroymerlin: `https://www.leroymerlin.pl/search?q=${term}&sort=price-asc`,
        obi: `https://www.obi.pl/search/${term}/?sortprice=asc`,
        mrowka: `https://mrowka.com.pl/wyszukiwanie?_Search=${term}`,
        action: `https://www.action.com/pl-pl/search/?sortBy=PRICE_ASC&q=${term}`,
        jysk: `https://jysk.pl/search?query=${term}&sort=price_asc&type=product`,
        empik: `https://www.empik.com/szukaj/produkt?qtype=facetForm&sort=priceAsc&q=${term}&availabilityLabel=do+24h&availabilityLabel=do+48h&availabilityLabel=do+72h&productStateFacet=new`,
        zooplus: `https://www.zooplus.pl/search/results?q=${term}&sorting=lowest-price`,
        maxizoo: `https://www.maxizoo.pl/search/?text=${term}&sort=price-asc`,
        bitiba: `https://www.bitiba.pl/search/results?q=${term}&sorting=lowest-price`
      };

      selectedShops.forEach(shop => {
        if (googleSearchEnabled) {
          const googleUrl = `https://www.google.com/search?q=site:${shop}.pl+${term}`;
          window.open(googleUrl, '_blank');
        } else {
          const url = urls[shop];
          if (url) {
            window.open(url, '_blank');
          }
        }
      });
    }

    // Reset formularza
    function resetForm() {
      searchTermInput.value = "";
      searchButton.disabled = true;
      shopCheckboxes.forEach(cb => cb.checked = false);
      selectAllCheckbox.checked = false;
      selectAllCheckbox.indeterminate = false;
      document.getElementById('googleSearch').checked = false;
    }
  </script>
</body>

</html>
